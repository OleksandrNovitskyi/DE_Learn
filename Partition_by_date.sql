USE [Northwind]
GO
BEGIN TRANSACTION
CREATE PARTITION FUNCTION [pf_ByOrderDate](datetime) AS RANGE RIGHT FOR VALUES (N'1996-01-01T00:00:00', N'1997-01-01T00:00:00', N'1998-01-01T00:00:00', N'1999-01-01T00:00:00', N'2000-01-01T00:00:00', N'2001-01-01T00:00:00', N'2002-01-01T00:00:00', N'2003-01-01T00:00:00', N'2004-01-01T00:00:00', N'2005-01-01T00:00:00')


CREATE PARTITION SCHEME [ps_ByOrderDate] AS PARTITION [pf_ByOrderDate] TO ([PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY])




CREATE CLUSTERED INDEX [ClusteredIndex_on_ps_ByOrderDate_638380723664429469] ON [dbo].[New Orders]
(
	[OrderDate]
)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF) ON [ps_ByOrderDate]([OrderDate])


DROP INDEX [ClusteredIndex_on_ps_ByOrderDate_638380723664429469] ON [dbo].[New Orders]






COMMIT TRANSACTION

-- Speed Testing
USE [Northwind]
SELECT * FROM [dbo].[New Orders] WHERE [OrderDate] BETWEEN '1997-12-13' AND '1998-02-05';

SELECT * FROM [dbo].[New Ordes2] WHERE [OrderDate] BETWEEN '1997-12-13' AND '1998-02-05';
